<!DOCTYPE html>
<html>
<head>
<title>Admin Panel | Aftab Store</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

<style>
body{font-family:Arial;margin:0;background:#111;color:#fff}

.box{
max-width:500px;
margin:20px auto;
background:#fff;
color:#000;
padding:15px;
border-radius:10px;
}

input,button{
width:100%;
padding:10px;
margin:5px 0;
}

button{
background:#28a745;
color:white;
border:none;
border-radius:6px;
}

.red{background:red}
</style>
</head>

<body>

<div class="box" id="loginBox">

<h3>ğŸ” Admin Login</h3>

<input id="email" placeholder="Email">
<input id="pass" type="password">

<button onclick="login()">Login</button>

<p id="msg"></p>

</div>


<div class="box" id="panel" style="display:none">

<h3>ğŸ“¦ Add Product</h3>

<input id="pname" placeholder="Product Name">
<input id="price" placeholder="Price">
<input id="stock" placeholder="Stock">

<button onclick="addProduct()">Add</button>

<hr>

<h3>ğŸ›’ Products</h3>
<div id="products"></div>

<hr>

<h3>ğŸ“¬ Orders</h3>
<div id="orders"></div>

<button class="red" onclick="logout()">Logout</button>

</div>


<script>

// FIREBASE
firebase.initializeApp({
apiKey: "AIzaSyA8O4kOinBczBQ8r9mbtOdH98X70ezpgYk",
authDomain: "new-prototype-s7zo4.firebaseapp.com",
projectId: "new-prototype-s7zo4"
});

const auth=firebase.auth();
const db=firebase.firestore();


// LOGIN
async function login(){

try{
await auth.signInWithEmailAndPassword(
email.value,pass.value
);

loginBox.style.display="none";
panel.style.display="block";

loadProducts();
loadOrders();

}catch{
msg.innerText="Wrong Login";
}

}


// LOGOUT
function logout(){
auth.signOut();
location.reload();
}


// ADD PRODUCT
async function addProduct(){

if(!pname.value||!price.value)return alert("Fill all");

await db.collection("Products").add({
name:pname.value,
price:price.value,
stock:stock.value
});

pname.value="";
price.value="";
stock.value="";

loadProducts();
}


// LOAD PRODUCTS
async function loadProducts(){

let snap=await db.collection("Products").get();

products.innerHTML="";

snap.forEach(d=>{

let p=d.data();

products.innerHTML+=`
<div>
${p.name} â‚¹${p.price} (Stock:${p.stock})
<button onclick="del('${d.id}')">âŒ</button>
</div>
`;

});

}


// DELETE
function del(id){
db.collection("Products").doc(id).delete();
loadProducts();
}


// LOAD ORDERS
async function loadOrders(){

let snap=await db.collection("Orders")
.orderBy("time","desc").get();

orders.innerHTML="";

snap.forEach(d=>{

let o=d.data();

orders.innerHTML+=`
<div style="border:1px solid #ccc;padding:5px;margin:5px">

<b>${o.name}</b> (${o.mobile})<br>
${o.items}<br>
â‚¹${o.total}

</div>
`;

});

}

</script>

</body>
</html>
